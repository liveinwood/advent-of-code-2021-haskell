{-# LANGUAGE OverloadedStrings #-}
module Main where
import           Data.Monoid
import qualified Data.Vector as V
import qualified Data.ByteString.Char8 as BS

-- import           Day1
-- import           Day10
-- import           Day12
import           Day13
-- import           Day2
-- import           Day3
-- import           Day4
-- import           Day5
-- import           Day6
-- import           Day7
-- import           Day8

main :: IO ()
main = do
    let
        v = make2dVector "1236,308\n296,291\n26,378\n391,705\n1272,434\n1221,595\n653,476\n1274,52\n97,54\n1295,690\n716,396\n522,739\n783,485\n1227,171\n159,463\n152,241\n611,892\n373,459\n912,10\n601,614\n1091,148\n391,637\n326,649\n561,436\n309,413\n1268,610\n237,411\n348,668\n745,259\n1255,350\n484,287\n402,306\n234,110\n430,60\n566,854\n830,689\n353,637\n156,516\n1200,254\n237,259\n574,438\n565,859\n1064,579\n248,350\n1076,802\n773,683\n1141,578\n1057,371\n1250,892\n764,619\n1160,345\n883,254\n1242,401\n1129,287\n1186,136\n1190,162\n932,52\n961,175\n157,540\n229,502\n1014,298\n326,425\n1298,57\n745,812\n987,207\n296,674\n94,834\n338,548\n856,842\n1250,722\n534,150\n1139,444\n78,96\n604,52\n485,764\n875,604\n1096,78\n1063,507\n1136,379\n452,588\n348,317\n1082,219\n1088,733\n619,306\n745,859\n1195,351\n912,894\n120,162\n1034,52\n1119,283\n694,534\n246,803\n316,570\n214,856\n150,113\n714,77\n744,40\n1110,842\n594,396\n912,690\n810,159\n440,822\n321,54\n432,861\n1190,380\n132,58\n323,207\n1123,595\n340,340\n1288,49\n127,485\n110,254\n1279,518\n657,448\n701,723\n109,619\n1155,114\n576,126\n170,327\n1010,250\n624,627\n1087,665\n1058,26\n888,549\n1258,701\n724,661\n865,204\n442,117\n703,95\n197,256\n750,711\n954,855\n1302,607\n1113,227\n150,666\n537,409\n524,605\n1136,827\n338,346\n1096,596\n574,787\n545,278\n1131,159\n1002,432\n353,298\n1134,228\n1091,66\n716,172\n1191,836\n1091,336\n642,101\n1072,292\n1047,189\n132,715\n853,3\n35,812\n898,666\n1250,577\n202,728\n16,175\n853,891\n117,623\n119,388\n537,623\n673,562\n952,855\n266,172\n966,495\n393,764\n812,791\n272,602\n545,275\n673,145\n745,595\n1009,639\n176,890\n1001,413\n852,345\n320,471\n422,661\n547,77\n1290,577\n246,315\n164,95\n219,596\n1042,77\n1258,641\n537,211\n534,723\n1289,735\n490,52\n104,189\n1295,103\n1091,784\n1186,318\n288,491\n136,121\n590,283\n1123,483\n676,317\n110,192\n653,782\n156,513\n574,14\n6,471\n1062,350\n1217,458\n1235,539\n293,567\n1283,59\n686,155\n202,754\n827,733\n323,655\n1072,723\n305,425\n768,368\n1277,32\n52,701\n1086,813\n875,290\n1052,493\n12,389\n811,285\n358,338\n273,843\n169,316\n113,49\n413,551\n706,233\n637,775\n176,4\n430,50\n880,50\n201,590\n1096,410\n619,540\n1274,842\n472,375\n780,318\n929,51\n422,549\n38,460\n818,315\n775,254\n227,618\n977,802\n1211,640\n530,12\n919,705\n209,836\n855,540\n929,359\n1096,298\n425,189\n878,861\n985,670\n750,101\n1156,735\n1275,812\n830,343\n94,263\n1193,354\n729,147\n296,596\n537,683\n191,283\n989,502\n228,891\n586,849\n952,338\n1108,883\n1280,556\n1210,462\n775,640\n416,238\n17,593\n1119,723\n1226,218\n907,763\n1099,679\n780,128\n308,407\n381,107\n1134,890\n708,192\n1310,350\n982,320\n1297,684\n580,28\n576,574\n274,416\n535,506\n682,826\n691,540\n1044,717\n773,409\n719,282\n517,830\n766,702\n932,842\n344,838\n825,130\n1134,605\n82,1\n480,689\n522,491\n214,618\n929,56\n902,91\n917,278\n818,799\n1257,723\n483,385\n937,843\n758,172\n80,803\n146,507\n176,325\n467,287\n852,793\n1195,543\n246,539\n80,8\n780,459\n686,892\n1298,289\n185,175\n400,882\n247,507\n976,607\n206,408\n669,460\n171,444\n1084,189\n1113,172\n537,872\n972,548\n252,26\n1290,541\n301,333\n276,374\n348,765\n1101,46\n1201,171\n370,527\n908,868\n910,12\n1014,556\n1252,817\n525,274\n1082,667\n1277,215\n528,276\n219,593\n329,446\n21,649\n656,544\n1175,499\n222,733\n353,703\n586,45\n586,717\n1093,171\n852,605\n535,388\n565,35\n1017,567\n1064,315\n242,255\n773,719\n196,112\n1198,374\n460,291\n579,539\n23,707\n118,52\n994,353\n673,640\n510,823\n1026,367\n621,414\n1233,707\n460,332\n638,728\n381,278\n574,456\n616,534\n985,446\n984,68\n565,812\n840,129\n196,101\n995,800\n701,171\n1086,492\n338,93\n320,404\n524,289\n273,555\n12,241\n1203,784\n1114,782\n580,866\n33,455\n498,381\n320,490\n1165,108\n112,618\n875,817\n929,339\n564,263\n541,49\n214,148\n1046,369\n816,768\n1097,14\n1,866\n30,892\n301,639\n1093,392\n306,765\n1037,51\n864,842\n305,175\n52,80\n1139,161\n765,54\n22,49\n181,607\n281,718\n724,401\n704,446\n1125,271\n13,145\n224,728\n749,234\n10,570\n1272,82\n328,425\n478,737\n1125,175\n115,7\n490,767\n1134,569\n689,563\n944,491\n1159,16\n1288,497\n686,267\n775,836\n25,596\n1073,635\n689,396\n999,56\n1118,179\n12,57\n115,543\n1275,588\n1280,2\n47,95\n530,459\n820,127\n1258,640\n956,644\n224,492\n1134,442\n1042,817\n709,168\n1125,63\n1272,883\n909,147\n720,283\n202,588\n170,119\n296,855\n35,588\n1277,563\n107,817\n909,523\n93,10\n976,791\n1274,500\n454,842\n505,434\n724,717\n535,640\n994,93\n400,12\n194,114\n432,33\n373,51\n883,724\n176,228\n884,675\n768,72\n349,229\n271,46\n884,168\n425,502\n12,605\n1252,77\n662,551\n1036,192\n1141,764\n594,562\n805,434\n110,631\n393,278\n982,126\n893,259\n171,733\n1233,259\n537,37\n957,74\n119,836\n408,803\n430,620\n776,171\n132,603\n544,702\n1304,471\n750,681\n820,763\n937,754\n164,842\n803,588\n977,502\n1098,565\n248,544\n562,110\n328,387\n252,588\n1226,676\n1275,540\n724,493\n793,606\n1183,228\n1297,145\n894,866\n1206,637\n537,354\n117,872\n254,12\n673,705\n1250,844\n642,228\n1076,784\n639,782\n1272,31\n996,549\n1029,802\n734,280\n604,681\n406,320\n1034,842\n1017,327\n785,256\n1195,343\n572,1\n1047,364\n1299,128\n743,19\n305,873\n867,663\n555,254\n1171,635\n997,749\n1280,450\n691,843\n309,705\n1174,773\n1101,847\n400,487\n202,870\n529,528\n668,57\n353,820\n214,298\n927,360\n1110,724\n0,203\n745,299\n1292,407\n1158,653\n457,891\n962,317\n546,51\n1298,228\n426,3\n435,66\n478,829\n381,499\n214,822\n300,250\n219,828\n82,768\n485,130\n209,204\n1134,793\n763,393\n1092,661\n545,54\n624,338\n624,556\n156,791\n850,506\n326,835\n1277,414\n2,14\n187,483\n214,746\n1257,168\n864,394\n1193,495\n825,764\n152,653\n469,271\n146,418\n763,77\n858,360\n1113,443\n1228,673\n276,38\n273,275\n637,145\n313,749\n308,487\n197,119\n296,603\n137,64\n63,282\n1263,760\n714,817\n484,42\n422,345\n137,736\n127,676\n1064,803\n880,85\n972,324\n776,408\n720,611\n435,784\n1190,648\n1110,170\n1160,666\n0,691\n984,516\n1221,35\n462,267\n124,318\n431,217\n720,163\n484,159\n736,787\n1310,691\n1037,555\n42,610\n155,733\n1310,842\n1218,784\n1014,220\n440,78\n135,499\n1155,733\n100,462\n1114,549\n536,500\n328,506\n1193,200\n957,298\n200,170\n764,51\n607,95\n537,175\n579,355\n83,723\n371,30\n773,211\n1193,683\n100,432\n219,53\n273,56\n283,30\n264,525\n580,199\n976,9\n567,19\n1250,317\n753,54\n150,381\n957,257\n219,148\n1293,189\n200,724\n438,799\n930,192\n1037,840\n869,880\n994,772\n1265,170\n82,344\n478,65\n328,350\n33,480\n806,333\n349,5\n883,52\n417,35\n251,131\n373,802\n704,222\n1283,835\n880,620\n244,712\n557,54\n1158,515\n1129,254\n58,77\n191,723\n805,460\n885,502\n33,32\n987,655\n669,434\n1298,101\n1161,434\n957,596\n80,886\n156,378\n1140,42\n430,834\n310,495\n1083,618\n136,773\n185,623\n560,681\n917,166\n263,82\n109,616\n89,595\n1086,81\n545,59\n929,395\n654,282\n637,254\n601,107\n522,263\n972,346\n989,54\n1158,689\n33,414\n552,315\n1005,425\n1014,596\n366,491\n1009,561\n1022,491\n258,849\n865,652\n641,658\n949,327\n55,350\n1154,791\n1027,30\n1220,631\n1292,487\n38,11\n1001,271\n435,817\n542,72\n691,218\n353,561\n966,56\n229,189\n402,866\n1102,500\n832,228\n1308,14\n305,623\n738,1\n214,484\n118,842\n224,50\n560,162\n716,780\n580,308\n1101,200\n229,392\n27,835\n570,415\n301,298\n281,802\n1221,588\n706,681\n338,570\n430,477\n783,857\n21,735\n249,828\n609,619\n15,690\n21,383\n197,227\n1250,765\n90,631\n937,170\n1114,112\n536,394\n599,544\n897,551\n793,64\n570,218\n1108,870\n422,213\n1173,606\n775,388\n185,271\n324,574\n552,579\n1192,394\n117,271\n768,36\n252,28\n0,842\n1110,52\n381,838\n1293,705\n373,473\n1289,159\n1198,618\n654,724\n1136,515\n30,450\n755,640\n45,312\n455,794\n619,843\n977,652\n1258,39\n176,569\n691,306\n152,827\n291,218\n473,80\n152,379\n90,263\n109,278\n435,290\n1113,256\n868,117\n176,793\n734,574\n120,380\n52,640\n730,308\n1186,103\n197,891\n427,254\n686,556\n1295,593\n1014,674\n266,450\n1014,338\n940,395\n932,394\n127,228\n937,473\n1309,28\n460,780\n1288,845\n504,289\n1222,656\n345,189\n293,327\n668,228\n1309,418\n746,711\n820,767\n1064,539\n601,168\n104,705\n127,857\n1129,786\n857,590\n607,799\n1054,204\n929,726\n1116,603\n782,276\n989,840\n1141,316\n214,276\n929,278\n855,794\n470,129\n1156,607\n1027,864\n252,238\n1193,623\n1072,171\n540,117\n202,166\n641,460\n17,327\n1,28\n1111,442\n499,733\n581,147\n1195,7\n47,134\n1221,147\n1088,861\n745,306\n18,487"
        inst = BS.lines "fold along x=655\nfold along y=447\nfold along x=327\nfold along y=223\nfold along x=163\nfold along y=111\nfold along x=81\nfold along y=55\nfold along x=40\nfold along y=27\nfold along y=13\nfold along y=6"
    solve inst v
